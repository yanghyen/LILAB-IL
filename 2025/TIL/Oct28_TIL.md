# 251028
## âœ…TO-DO
- âœ…ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ ì‹¤í—˜ ëŒë¦¬ê¸° ìœ„í•œ ë©”ëª¨ë¦¬ ë¬¸ì œ í•´ê²°
- Word2Vec ì‹¤í—˜ ëª©ë¡ ì •ë¦¬
    - ë…¼ë¬¸ ì½ê³  ì‹¤í—˜ ì •ë¦¬
    - config íŒŒì¼ ë§Œë“¤ì–´ë‘ê¸°
    - ver2ì˜ ê²°ê³¼ë¬¼ ê²½ë¡œ íŒŒì•…
- Word2Vec paper ì‘ì„±

## ğŸ“ŒToday I Learned
### ìŠ¤íŠ¸ë¦¬ë°ì„ ìœ„í•œ ê°œë…ë“¤
#### Generator & yeild
- iterable: ë°˜ë³µ ê°€ëŠ¥í•œ ê°œì²´(list, dict, set, str, bytes, tuple, range)
- iterator: ê°’ì„ ì°¨ë¡€ëŒ€ë¡œ êº¼ë‚¼ ìˆ˜ ìˆëŠ” ê°ì²´. iterableí•œ ê°ì²´ë¥¼ ë‚´ì¥í•¨ìˆ˜ë‚˜ iterableê°ì²´ì˜ ë©”ì†Œë“œë¡œ ê°ì²´ ìƒì„± ê°€ëŠ¥ 
    - ```iter()```ì„ ì‚¬ìš©í•´ì„œ ê°ì²´ ë§Œë“¤ ìˆ˜ ìˆìŒ 
- generator: iteratorë¥¼ ìƒì„±í•´ì£¼ëŠ” í•¨ìˆ˜. í•¨ìˆ˜ ì•ˆì— yield í‚¤ì›Œë“œ ì‚¬ìš© 
- íŠ¹ì§•
    - iterableí•œ ìˆœì„œê°€ ì§€ì •ë¨(ëª¨ë“  generatorëŠ” iterator)
    - ìˆœì„œì˜ ë‹¤ìŒ ê°’ì€ í•„ìš”ì— ë”°ë¼ ê³„ì‚°ë¨
    - í•¨ìˆ˜ì˜ ë‚´ë¶€ ë¡œì»¬ ë³€ìˆ˜ë¥¼ í†µí•´ ë‚´ë¶€ìƒíƒœê°€ ìœ ì§€ë¨
    - ë¬´í•œí•œ ìˆœì„œê°€ ìˆëŠ” ê°ì²´ë¥¼ ëª¨ë¸ë§í•  ìˆ˜ ìˆìŒ
    - ìì—°ìŠ¤ëŸ¬ìš´ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ë¥¼ ìœ„ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµ¬ì„± ê°€ëŠ¥
- yield ê°€ í˜¸ì¶œë˜ë©´ ì•”ì‹œì ìœ¼ë¡œ returnì´ í˜¸ì¶œë˜ë©°, í•œë²ˆ ë” ì‹¤í–‰ë˜ë©´ ì‹¤í–‰ë˜ì—ˆë˜ `yield' ë‹¤ìŒ ì½”ë“œê°€ ì‹¤í–‰
```py
def test_generator():
     yield 1
     yield 2
     yield 3
 
>>> gen = test_generator()
>>> type(gen)
<class 'generator'>
>>> next(gen)
1
>>> next(gen)
2
>>> next(gen)
3
>>> next(gen)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
StopIteration
```

#### IterableDataset
- í•™ìŠµ ë°ì´í„°ê°€ ë©”ëª¨ë¦¬ì— ë‹¤ ì˜¬ë¼ê°€ì§€ ì•ŠëŠ” ê²½ìš°ì— ì“°ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì´ë‹¤. 
- ì´ë•Œ ê³µì‹ë¬¸ì„œì— ë”°ë¥´ë©´ ```IterableDataset```ì„ ```num_workers > 0```ì˜ ì¡°ê±´ì—ì„œ ì‚¬ìš©í•  ë•Œ ì£¼ì˜í•´ì•¼ í•  ì‚¬í•­ì´ ìˆë‹¤.
    - num_workersëŠ” ë°ì´í„°ì…‹ì„ ë¶ˆëŸ¬ì˜¬ ë•Œ ì‚¬ìš©í•  subprocessì˜ ê°œìˆ˜ì´ë‹¤. main processëŠ” subprocessì—ì„œ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ modelì— passí•˜ëŠ” ì—­í• ë§Œ ë‹´ë‹¹í•´ì„œ ë³‘ëª©ì´ ì¤„ì–´ë“¤ê³  gpu utilizationì„ 100% ê°€ê¹Œì´ë¡œ ëŒì–´ì˜¬ë¦´ ìˆ˜ ìˆë‹¤. 
    - Map-Style Datasetì€ subprocessë§ˆë‹¤ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.
    - í•˜ì§€ë§Œ, Iterable Datasetì€ ê° ì›Œì»¤ê°€ ê°™ì€ ```__iter__()```ì„ ì‚¬ìš©í•´ì„œ ê°™ì€ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ê²Œ ëœë‹¤.
- ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ```wordker_init_fn```ì—ì„œ ì§ì ‘ ì›Œì»¤ ë³„ ë°ì´í„°ë¥¼ ì¬ë¶„ë°° ì‹œì¼œì¤˜ì•¼ í•œë‹¤.
```py
def worker_init_fn(_):
    worker_info = torch.utils.data.get_worker_info()

    dataset = worker_info.dataset
    worker_id = worker_info.id
    split_size = len(dataset.data) // worker_info.num_workers

    dataset.data = dataset.data[worker_id * split_size: (worker_id + 1) * split_size]
```
```py
loader = DataLoader(iterable_dataset, batch_size=4, num_workers=2, worker_init_fn=worker_init_fn)
for d in loader:
    batch, worker_ids, starts, ends = d
    print(batch, worker_ids)
# ----------
# tensor([0, 1, 2, 3]) tensor([0, 0, 0, 0])
# tensor([ 8,  9, 10, 11]) tensor([1, 1, 1, 1])
# tensor([4, 5, 6, 7]) tensor([0, 0, 0, 0])
# tensor([12, 13, 14, 15]) tensor([1, 1, 1, 1])
```

## ğŸ’¡ íšŒê³  / ì¸ì‚¬ì´íŠ¸
### gpt ì˜ì¡´ì¦,,
- gptì˜ ì½”ë“œì™€ ì •ë³´ë§Œ ì˜ì§€í•´ì„  ì•ˆëœë‹¤. ê·¸ë¦¬ê³  gptì—ì„œ ì œì‹œí•œ ë‚´ìš©ì„ gptì˜ ê²°ê³¼ë¥¼ ì½ê³  ì •ë¦¬í•˜ëŠ” ê²ƒë³´ë‹¤ êµ¬ê¸€ë§ì„ í•œë²ˆ í•´ë³´ë©´ ë” ë‚´ ê²ƒì´ ëœë‹¤. 

## ğŸ’¥ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
### ë¬¸ì œ ìƒí™©: ë©”ëª¨ë¦¬ ë¬¸ì œë¡œ ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“œë¡œ í•™ìŠµí•´ë„ í•™ìŠµì´ ì¤‘ë‹¨ëœë‹¤.
- ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ìœ¼ë¡œ í•™ìŠµí•´ë„ Optimizerê°€ íŒŒë¼ë¯¸í„°ë§ˆë‹¤ stateë¥¼ ì €ì¥í•˜ê³ , ë‚´ë¶€ ìºì‹œê°€ ëˆ„ì ë¼ì„œ ì¡°ê¸ˆì”© RAM ì‚¬ìš©ëŸ‰ì´ ëŠ˜ì–´ë‚œë‹¤. í•™ìŠµì‹œê°„ì´ ê¸¸ë‹¤ë³´ë‹ˆ RAM ì‚¬ìš©ëŸ‰ì´ ì„ê³„ì¹˜ë¥¼ ë„˜ê²Œ ë˜ë©´ OOMì´ í•™ìŠµì„ ì¤‘ë‹¨ì‹œí‚¨ë‹¤.
### í•´ê²°ë°©ë²•
- ì¼ì • ìŠ¤í…ë§ˆë‹¤ ì²´í¬í¬ì¸íŠ¸ë¥¼ ì €ì¥í•˜ê²Œ í•œ ë’¤, ìŠ¤í¬ë¦½íŠ¸ë¬¸ì„ í•™ìŠµì´ ì™„ë£Œë˜ì§€ ì•Šìœ¼ë©´ ë°˜ë³µ ì‹¤í–‰í•˜ê²Œ í•œë‹¤. ì´ë•Œ í•™ìŠµì„ ì¬ê°œí•  ë•ŒëŠ” ë§ˆì§€ë§‰ìœ¼ë¡œ ì €ì¥ëœ ì²´í¬í¬ì¸íŠ¸ íŒŒì¼ì„ ë¶ˆëŸ¬ì™€ì„œ ì§„í–‰í•œë‹¤.

## ğŸ©ë‚´ì¼ í•  ì¼ 
- Word2Vec ì‹¤í—˜ ëª©ë¡ ì •ë¦¬
    - ë…¼ë¬¸ ì½ê³  ì‹¤í—˜ ì •ë¦¬
    - config íŒŒì¼ ë§Œë“¤ì–´ë‘ê¸°
    - ver2ì˜ ê²°ê³¼ë¬¼ ê²½ë¡œ íŒŒì•…
- Word2Vec paper ì‘ì„±